WHITESPACE = _{ " " | "\t" | "\n" | "\r\n" }

// =======================
// Expressions
// =======================

expression = { SOI ~ assignment ~ EOI }

assignment = { logical ~ ( assign_op ~ assignment )? }
assign_op = { "=" ~ !"=" }

// Logical operators
logical = { comparison ~ ( logical_op ~ comparison )* }
logical_op = { "&&" | "||" }

// Comparison operators
comparison = { arithmetic ~ ( comp_op ~ arithmetic )* }
comp_op = { "==" | "!=" | ">=" | "<=" | ">" | "<" }

// Arithmetic operators
arithmetic = { unary ~ ( arith_op ~ unary )* }
arith_op = { "+" | "-" | "*" | "/" }

// Unary
unary = { unary_op* ~ primary }
unary_op = { "-" | "!" }

// Primary expressions
primary = {
    function_call
    | column
    | literal
    | "(" ~ expression ~ ")"
}

// Function calls
function_call = {
    identifier ~ "(" ~ (logical ~ ("," ~ logical)*)? ~ ")"
}

// Column access
column = { "$" ~ ( identifier | quoted_identifier ) }

// =======================
// Literals
// =======================

literal = { float | integer | boolean | string }

integer = @{ "-"? ~ ASCII_DIGIT+ }

float   = @{ "-"? ~ ASCII_DIGIT+ ~ "." ~ ASCII_DIGIT+ }

boolean = { "true" | "false" }

string  = { quoted_identifier }

// =======================
// Identifiers
// =======================

identifier = @{ (ASCII_ALPHA | "_") ~ (ASCII_ALPHANUMERIC | "_")* }

quoted_identifier = @{ "\"" ~ (!"\"" ~ ANY)+ ~ "\"" }
